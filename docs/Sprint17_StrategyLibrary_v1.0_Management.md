# Sprint 17: Strategy Library v1.0 Management

## ç›®çš„
Strategy Library ã«ä¿å­˜ã•ã‚ŒãŸã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚’åŠ¹ç‡çš„ã«ç®¡ç†ãƒ»æ•´ç†ãƒ»å†åˆ©ç”¨ã™ã‚‹ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

## å®Ÿè£…å†…å®¹

### 1. StrategyLibrary ã‚¯ãƒ©ã‚¹ã®æ‹¡å¼µ

#### æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰
- **`update_strategy(strategy_id, updates)`**: ç‰¹å®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°
- **`delete_strategy(strategy_id)`**: æˆ¦ç•¥ã‚’IDã§å‰Šé™¤
- **`toggle_favorite(strategy_id)`**: ãŠæ°—ã«å…¥ã‚Šãƒ•ãƒ©ã‚°ã‚’åˆ‡ã‚Šæ›¿ãˆ

#### ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ‹¡å¼µ
```json
{
  ...existing fields...,
  "favorite": false  // æ—¢å­˜æˆ¦ç•¥ã¯ false ã§åˆæœŸåŒ–
}
```

### 2. Strategy Lab - Saved Strategies ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å¼·åŒ–

#### ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½
- **Symbol ãƒ•ã‚£ãƒ«ã‚¿**: "All" ã¾ãŸã¯ä¿å­˜æ¸ˆã¿æˆ¦ç•¥ã® Symbol ã‹ã‚‰é¸æŠ
- **Timeframe ãƒ•ã‚£ãƒ«ã‚¿**: "All" / "1d" / "1h" / "5m" ã‹ã‚‰é¸æŠ
- **â­ Favorites only**: ãŠæ°—ã«å…¥ã‚Šã®ã¿è¡¨ç¤ºã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹

#### ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
- Return (%) - åç›Šç‡é †
- Max Drawdown - æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³é †
- Created (newest) - ä½œæˆæ—¥æ™‚ï¼ˆæ–°ã—ã„é †ï¼‰
- Created (oldest) - ä½œæˆæ—¥æ™‚ï¼ˆå¤ã„é †ï¼‰
- Name - åå‰é †

#### ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
- **â­ åˆ—**: ãŠæ°—ã«å…¥ã‚Šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤ºï¼ˆâ­ / â˜†ï¼‰
- ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆé©ç”¨å¾Œã®ä»¶æ•°ã‚’è¡¨ç¤º: "Found X strategies"

#### ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
æˆ¦ç•¥ã‚’é¸æŠã—ã¦ä»¥ä¸‹ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œå¯èƒ½:

1. **â­ Toggle Favorite**: ãŠæ°—ã«å…¥ã‚Šã®ã‚ªãƒ³/ã‚ªãƒ•åˆ‡ã‚Šæ›¿ãˆ
2. **ğŸ“‚ Load**: Strategy Lab ã®ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰
3. **âœï¸ Rename**: 
   - ã‚¯ãƒªãƒƒã‚¯ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
   - æ–°ã—ã„åå‰ã‚’å…¥åŠ›
   - ğŸ’¾ Save / âŒ Cancel
4. **ğŸ—‘ï¸ Delete**:
   - ã‚¯ãƒªãƒƒã‚¯ã§ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
   - âš ï¸ è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
   - ğŸ—‘ï¸ Confirm Delete / âŒ Cancel

### 3. Backtest Lab - ãƒ­ãƒ¼ãƒ‰ä¸­æˆ¦ç•¥ã®æƒ…å ±è¡¨ç¤º

ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã®æˆ¦ç•¥ãŒã‚ã‚‹å ´åˆã€ä»¥ä¸‹ã®æƒ…å ±ã‚’ expander ã§è¡¨ç¤º:

```
ğŸ“‹ Currently Loaded Strategy

Name: Strategy Name
Symbol: AAPL
Timeframe: 1d
Parameters: MA(13, 40)
Return: 1625.54%
Description: (ã‚‚ã—ã‚ã‚Œã°)
```

**è¡¨ç¤ºæ¡ä»¶**: 
- Symbol, Short Window, Long Window ãŒä¸€è‡´ã™ã‚‹æˆ¦ç•¥ã‚’è‡ªå‹•æ¤œå‡º
- è©²å½“æˆ¦ç•¥ãŒãªã„å ´åˆã¯éè¡¨ç¤º

## å®Ÿè¡Œæ–¹æ³•

### 1. Strategy Lab ã§ã®ç®¡ç†
```bash
streamlit run dev_dashboard.py
```

**Strategy Lab ã‚¿ãƒ–** â†’ **Saved Strategies ã‚»ã‚¯ã‚·ãƒ§ãƒ³**:
1. ãƒ•ã‚£ãƒ«ã‚¿ã¨ã‚½ãƒ¼ãƒˆã‚’è¨­å®š
2. æˆ¦ç•¥ã‚’é¸æŠ
3. ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã§æ“ä½œï¼ˆFavorite, Load, Rename, Deleteï¼‰

### 2. Backtest Lab ã§ã®ç¢ºèª
**Backtest Lab ã‚¿ãƒ–**:
1. "ğŸ“š Load from Strategy Library" ã§æˆ¦ç•¥ã‚’ãƒ­ãƒ¼ãƒ‰
2. "ğŸ“‹ Currently Loaded Strategy" expander ã§æƒ…å ±ç¢ºèª
3. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè‡ªå‹•ã‚»ãƒƒãƒˆæ¸ˆã¿ã‚’ç¢ºèª
4. "â–¶ Run Backtest" ã§å®Ÿè¡Œ

## æŠ€è¡“çš„è©³ç´°

### ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- **ä¿å­˜å…ˆ**: `data/strategies.json`
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: JSON (indent=2 for readability)
- **å¾Œæ–¹äº’æ›æ€§**: æ—¢å­˜æˆ¦ç•¥ã« `favorite: false` ã‚’è‡ªå‹•è¿½åŠ 

### Session State ç®¡ç†
- **Rename dialog**: `rename_strategy_id`, `rename_strategy_name`
- **Delete confirmation**: `delete_strategy_id`, `delete_strategy_name`
- **Loaded strategy**: `strategy_lab_loaded_strategy`

### ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆãƒ­ã‚¸ãƒƒã‚¯
1. ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ï¼ˆSymbol, Timeframe, Favoriteï¼‰
2. ã‚½ãƒ¼ãƒˆã‚’é©ç”¨
3. çµæœã‚’è¡¨ç¤º

## ä»Šå¾Œã®æ‹¡å¼µæ¡ˆ
- **ã‚¿ã‚°æ©Ÿèƒ½**: æˆ¦ç•¥ã«è¤‡æ•°ã®ã‚¿ã‚°ã‚’ä»˜ä¸
- **ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**: JSON ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ export/import
- **æˆ¦ç•¥ã®æ¯”è¼ƒ**: è¤‡æ•°æˆ¦ç•¥ã‚’ä¸¦ã¹ã¦æ¯”è¼ƒè¡¨ç¤º
- **è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: strategies.json ã®è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **æ¤œç´¢æ©Ÿèƒ½**: åå‰ã‚„èª¬æ˜æ–‡ã§ã®å…¨æ–‡æ¤œç´¢
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å±¥æ­´**: æˆ¦ç•¥ã®éå»ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœã‚’è¨˜éŒ²
