# EXITON Frontend - Backtest Simulation

React + TypeScript + Vite ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ¯ æ¦‚è¦

EXITON ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã® `/simulate` API ã‚’ä½¿ç”¨ã—ã¦ã€ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æˆ¦ç•¥ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€çµæœã‚’è¦–è¦šåŒ–ã™ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Node.js 18+ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIãŒ `http://localhost:8000` ã§ç¨¼åƒä¸­

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
cd frontend
npm install
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:3000` ã‚’é–‹ãã¾ã™ã€‚

### ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰

```bash
npm run build
```

ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ `dist/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

### ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼

```bash
npm run preview
```

## ğŸ”§ ç’°å¢ƒå¤‰æ•°

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰URLã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š

```
VITE_API_BASE_URL=http://localhost:8000
```

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `http://localhost:8000` ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

Vite ã®ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã«ã‚ˆã‚Šã€é–‹ç™ºæ™‚ã¯ `/simulate` ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè‡ªå‹•çš„ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«è»¢é€ã•ã‚Œã¾ã™ã€‚

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ backtest.ts          # ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆAPIå‹å®šç¾©ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ SimulationForm.tsx   # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”‚   â”œâ”€â”€ SimulationForm.css
â”‚   â”‚   â”œâ”€â”€ MetricsPanel.tsx     # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ãƒ‘ãƒãƒ«
â”‚   â”‚   â”œâ”€â”€ MetricsPanel.css
â”‚   â”‚   â”œâ”€â”€ EquityChart.tsx      # è³‡ç”£æ¨ç§»ãƒãƒ£ãƒ¼ãƒˆï¼ˆRechartsï¼‰
â”‚   â”‚   â”œâ”€â”€ EquityChart.css
â”‚   â”‚   â”œâ”€â”€ TradesTable.tsx      # ãƒˆãƒ¬ãƒ¼ãƒ‰å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«
â”‚   â”‚   â””â”€â”€ TradesTable.css
â”‚   â”œâ”€â”€ App.tsx                  # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ App.css
â”‚   â”œâ”€â”€ main.tsx                 # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â””â”€â”€ index.css
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ README.md
```

## ğŸ¨ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### SimulationForm

ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 

**å…¥åŠ›é …ç›®:**
- Symbol (éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰)
- Timeframe (æ™‚é–“è¶³)
- Start Date / End Date (æœŸé–“)
- Strategy (æˆ¦ç•¥: MA Cross)
- Initial Capital (åˆæœŸè³‡é‡‘)
- Commission (æ‰‹æ•°æ–™ç‡)
- Position Size (ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚º)
- Short/Long MA Window (ç§»å‹•å¹³å‡æœŸé–“)

**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³:**
- Short Window < Long Window
- Initial Capital > 0
- Commission: 0-1

### MetricsPanel

ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™è¡¨ç¤º

**è¡¨ç¤ºæŒ‡æ¨™:**
- Total P&L (ç·æç›Š)
- Return (ãƒªã‚¿ãƒ¼ãƒ³ç‡)
- Max Drawdown (æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³)
- Win Rate (å‹ç‡)
- Total Trades (ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°)
- Final Equity (æœ€çµ‚è³‡ç”£)

### EquityChart

è³‡ç”£æ¨ç§»ã‚°ãƒ©ãƒ•ï¼ˆRechartsä½¿ç”¨ï¼‰

**è¡¨ç¤ºå†…å®¹:**
- Equity (è³‡ç”£ç·é¡)
- Cash (ç¾é‡‘)
- Xè»¸: æ—¥ä»˜
- Yè»¸: é‡‘é¡ï¼ˆÂ¥è¡¨ç¤ºï¼‰

### TradesTable

ãƒˆãƒ¬ãƒ¼ãƒ‰å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«

**ã‚«ãƒ©ãƒ :**
- Date (æ—¥ä»˜)
- Side (BUY/SELL)
- Price (ä¾¡æ ¼)
- Quantity (æ•°é‡)
- Commission (æ‰‹æ•°æ–™)
- P&L (æç›Š)
- Cash After (ãƒˆãƒ¬ãƒ¼ãƒ‰å¾Œç¾é‡‘)

## ğŸ”Œ APIé€£æº

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API

```typescript
// å‹å®šç¾©ã¯ src/api/backtest.ts ã«è¨˜è¼‰

interface BacktestRequest {
  symbol: string;
  timeframe?: string;
  start_date?: string;
  end_date?: string;
  strategy?: string;
  initial_capital?: number;
  commission?: number;
  position_size?: number;
  short_window?: number;
  long_window?: number;
}

interface BacktestResponse {
  symbol: string;
  timeframe: string;
  strategy: string;
  metrics: BacktestMetrics;
  trades: BacktestTrade[];
  equity_curve: EquityPoint[];
  data_points: number;
}
```

### APIå‘¼ã³å‡ºã—ä¾‹

```typescript
import { runSimulation } from './api/backtest';

const response = await runSimulation({
  symbol: 'AAPL',
  timeframe: '1d',
  start_date: '2020-01-01',
  end_date: '2023-12-31',
  strategy: 'ma_cross',
  short_window: 9,
  long_window: 21
});

console.log(response.metrics.return_pct);
```

## ğŸ¨ UIãƒ†ãƒ¼ãƒ

**ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ:**
- èƒŒæ™¯: `#0f0f1e` (ãƒ€ãƒ¼ã‚¯ãƒ–ãƒ«ãƒ¼)
- ã‚«ãƒ¼ãƒ‰: `#1a1a2e`
- ãƒœãƒ¼ãƒ€ãƒ¼: `#2a2a4e`
- ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼: `#4a9eff` (ãƒ–ãƒ«ãƒ¼)
- åˆ©ç›Š: `#4ade80` (ã‚°ãƒªãƒ¼ãƒ³)
- æå¤±: `#ff4a4a` (ãƒ¬ãƒƒãƒ‰)

**ãƒ‡ã‚¶ã‚¤ãƒ³ç‰¹å¾´:**
- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒï¼ˆç›®ã«å„ªã—ã„ï¼‰
- ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ é¢¨ã‚«ãƒ¼ãƒ‰
- ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
- ã‚¹ãƒ ãƒ¼ã‚ºãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ“± ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—: ãƒ•ãƒ«ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ: 2ã‚«ãƒ©ãƒ ã‚°ãƒªãƒƒãƒ‰
- ãƒ¢ãƒã‚¤ãƒ«: ã‚·ãƒ³ã‚°ãƒ«ã‚«ãƒ©ãƒ 

ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ: `768px`

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•:
```bash
cd ..
uvicorn backend.main:app --reload
```

2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•:
```bash
cd frontend
npm run dev
```

3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:3000` ã‚’é–‹ã

4. ãƒ†ã‚¹ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³:
   - Symbol: AAPL
   - Timeframe: 1d
   - Start: 2020-01-01
   - End: 2023-12-31
   - ãã®ä»–ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
   - ã€ŒRun Simulationã€ã‚¯ãƒªãƒƒã‚¯

5. çµæœç¢ºèª:
   - ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ‘ãƒãƒ«è¡¨ç¤º
   - è³‡ç”£æ¨ç§»ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º
   - ãƒˆãƒ¬ãƒ¼ãƒ‰å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«æ¥ç¶šã§ããªã„

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- URLãŒ `http://localhost:8000` ã‹ç¢ºèª
- CORSã‚¨ãƒ©ãƒ¼ã®å ´åˆã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®`main.py`ã§CORSè¨­å®šã‚’ç¢ºèª

### ãƒãƒ£ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„

- ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
- ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãå–å¾—ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `equity_curve` ãŒç©ºã§ãªã„ã‹ç¢ºèª

### ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

```bash
rm -rf node_modules
npm install
npm run build
```

## ğŸ“š è¿½åŠ æƒ…å ±

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIä»•æ§˜: `../03BACKTEST_SPEC.md`
- Vite ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://vitejs.dev/
- React ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://react.dev/
- Recharts ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://recharts.org/

## ğŸ“ ä»Šå¾Œã®æ‹¡å¼µ

- [ ] ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜æ©Ÿèƒ½
- [ ] è¤‡æ•°æˆ¦ç•¥ã®æ¯”è¼ƒæ©Ÿèƒ½
- [ ] CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- [ ] ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–UI
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œ
- [ ] ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ

---

**é–‹ç™ºè€…**: Kosuke Nakamura  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.2.0  
**æœ€çµ‚æ›´æ–°**: 2025-11-29
